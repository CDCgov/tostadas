nextflow_process {

    name "Test Process SUBMISSION"
    script "modules/local/submit_submission/main.nf"
    process "SUBMISSION"

    test("Run with profile test, virus | biosample") {

        when {
            params {
                // define parameters here
                submission_prod_or_test = "test"
                send_submission_email = false
                submission_mode = "ftp"
                output_dir = "${outputDir}" // (?: what does this NF variable resolve to?  surely not $params.output_dir?)
                metadata_basename = "mpxv_test_metadata"
                overwrite_output = true
                dryrun = true // (?: not exactly sure how to make this work)
            }

            process {
                """
                // define inputs of the process here
                input[0] = path("${projectDir}/tests/modules/local/prep_submission/batch_1/")
                input[1] = path("${projectDir}/conf/submission_config.yaml")
                """
            }
        }

        then {
            assert process.success
            // todo: add a test of the dry run output

        }
    }
}
