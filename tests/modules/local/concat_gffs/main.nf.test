nextflow_process {

    name "Test Process CONCAT_GFFS"
    script "modules/local/concat_gffs/main.nf"
    process "CONCAT_GFFS"

    test("Should run without failures") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                input[0] = file("${projectDir}/assets/ref/ref.MPXV.NC063383.v7.gff")
                input[1] = [ [ id: "NY0006" ], file("${projectDir}/tests/modules/local/concat_gffs/batch_1.tsv"), 
                                      file("${projectDir}/assets/sample_fastas/mpox/NY0006.fasta"), 
                                      file("${projectDir}/assets/sample_fastqs/mpox/2022-028-7666_S3_L001_R1_001.fastq.gz"), 
                                      file("${projectDir}/assets/sample_fastqs/mpox/2022-028-7666_S3_L001_R2_001.fastq.gz"),
                                      file("${projectDir}/tests/modules/local/concat_gffs/NY0006.fasta.out.gff"),
                                      file("${projectDir}/tests/modules/local/concat_gffs/NY0006.liftoff-orig.gff") ]

                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }

    }

}
