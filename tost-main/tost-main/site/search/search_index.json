{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home Overview TOSTADAS is designed to fulfill common sequence submission use cases. The tool runs three sub-processes: Metadata Validation \u2013 This workflow checks if metadata conforms to NCBI standards and matches the input .fasta file(s) Gene Annotation \u2013 This workflow runs gene annotation on fasta-formatted genomes using one of three annotation methods: RepeatMasker and Liftoff, VADR or BAKTA Submission \u2013 This workflow generates the necessary files and information for submission to NCBI and optionally and optionally submit to NCBI. TOSTADAS is flexible, allowing you to choose which portions of the pipeline to run and which to skip. For example, you can submit .fastq files and metadata without performing gene annotation. The current distribution has been tested with Pox virus sequences as well as some bacteria. Ongoing development aims to make the pipeline pathogen agnostic. Pipeline Summary Metadata Validation The validation workflow checks that user provided metadata conforms to NCBI standards and matches the input data file(s). To allow for easy multi-sample submission, TOSTADAS can split a multi-sample Excel (.xlsx) file into separate tab delimited files (.tsv) for each individual sample. TOSTADAS can accept custom metadata fields specific to a users' pathogen, sample type, or workflow. Additionally, TOSTADAS offers powerful validation tools for user- created fields, allowing users to specify which samples to apply rules to, replace empty values with user specified replacements, rename existing fields and other operations. These features can be enabled with the validate_custom_fields parameter. Custom fields can be specified using the custom_fields_file parameter. A full guide to using custom metadata fields can be found here: Custom Metadata Guide Gene Annotation TOSTADAS offers three optional annotation options: RepeatMasker and Liftoff The RepeatMasker and Liftoff workflow annotates fasta-formatted sequences based upon a provided reference and annotation file. This workflow was optimized for variola genome annotation and may require modification for other pathogens. This workflow runs RepeatMasker to annotate repeat motifs, followed by Liftoff to annotate functional regions. These results are combined into a single feature file (.gff3). The Liftoff annotation workflow requires a reference genome (.fasta), reference feature .gff, single sample .fasta files, and metadata in Excel .xlsx format. Be sure to specify the correct database in the params for this option. RepeatMasker and Liftoff Example VADR The VADR workflow annotates fasta-formatted viral genomes using RefSeq annotation from a set of homologous reference models. This workflow requires single sample fasta files, metadata in .xlsx format, and reference information for the pathogen genome. TOSTADAS comes packaged with support for [monkeypox (mpxv) annotation] (https://github.com/CDCgov/tostadas/tree/master/vadr_files/mpxv-models). You can find information on other supported pathogens at the [VADR GitHub Repository] (https://github.com/ncbi/vadr). [VADR Example] (Link) Bakta The Bakta workflow annotates fasta-formatted bacterial genomes & plasmids using the Bakta software. This workflow requires single sample .fasta files, metadata in .xlsx format, and optional reference database for annotation (found here). [BAKTA Example] (Link) All annotation workflows produce a general feature format file (.gff3) and NCBI feature table (tbl) compatible with NCBI submission requirements. Submission The TOSTADAS Submission workflow generates the necessary files for Genbank submission, a BioSample ID, then optionally uploads Fastq files via FTP to SRA. This workflow was adapted from SeqSender public database submission pipeline.","title":"Home"},{"location":"#home","text":"","title":"Home"},{"location":"#overview","text":"TOSTADAS is designed to fulfill common sequence submission use cases. The tool runs three sub-processes: Metadata Validation \u2013 This workflow checks if metadata conforms to NCBI standards and matches the input .fasta file(s) Gene Annotation \u2013 This workflow runs gene annotation on fasta-formatted genomes using one of three annotation methods: RepeatMasker and Liftoff, VADR or BAKTA Submission \u2013 This workflow generates the necessary files and information for submission to NCBI and optionally and optionally submit to NCBI. TOSTADAS is flexible, allowing you to choose which portions of the pipeline to run and which to skip. For example, you can submit .fastq files and metadata without performing gene annotation. The current distribution has been tested with Pox virus sequences as well as some bacteria. Ongoing development aims to make the pipeline pathogen agnostic.","title":"Overview"},{"location":"#pipeline-summary","text":"","title":"Pipeline Summary"},{"location":"#metadata-validation","text":"The validation workflow checks that user provided metadata conforms to NCBI standards and matches the input data file(s). To allow for easy multi-sample submission, TOSTADAS can split a multi-sample Excel (.xlsx) file into separate tab delimited files (.tsv) for each individual sample. TOSTADAS can accept custom metadata fields specific to a users' pathogen, sample type, or workflow. Additionally, TOSTADAS offers powerful validation tools for user- created fields, allowing users to specify which samples to apply rules to, replace empty values with user specified replacements, rename existing fields and other operations. These features can be enabled with the validate_custom_fields parameter. Custom fields can be specified using the custom_fields_file parameter. A full guide to using custom metadata fields can be found here: Custom Metadata Guide","title":"Metadata Validation"},{"location":"#gene-annotation","text":"TOSTADAS offers three optional annotation options:","title":"Gene Annotation"},{"location":"#repeatmasker-and-liftoff","text":"The RepeatMasker and Liftoff workflow annotates fasta-formatted sequences based upon a provided reference and annotation file. This workflow was optimized for variola genome annotation and may require modification for other pathogens. This workflow runs RepeatMasker to annotate repeat motifs, followed by Liftoff to annotate functional regions. These results are combined into a single feature file (.gff3). The Liftoff annotation workflow requires a reference genome (.fasta), reference feature .gff, single sample .fasta files, and metadata in Excel .xlsx format. Be sure to specify the correct database in the params for this option. RepeatMasker and Liftoff Example","title":"RepeatMasker and Liftoff"},{"location":"#vadr","text":"The VADR workflow annotates fasta-formatted viral genomes using RefSeq annotation from a set of homologous reference models. This workflow requires single sample fasta files, metadata in .xlsx format, and reference information for the pathogen genome. TOSTADAS comes packaged with support for [monkeypox (mpxv) annotation] (https://github.com/CDCgov/tostadas/tree/master/vadr_files/mpxv-models). You can find information on other supported pathogens at the [VADR GitHub Repository] (https://github.com/ncbi/vadr). [VADR Example] (Link)","title":"VADR"},{"location":"#bakta","text":"The Bakta workflow annotates fasta-formatted bacterial genomes & plasmids using the Bakta software. This workflow requires single sample .fasta files, metadata in .xlsx format, and optional reference database for annotation (found here). [BAKTA Example] (Link) All annotation workflows produce a general feature format file (.gff3) and NCBI feature table (tbl) compatible with NCBI submission requirements.","title":"Bakta"},{"location":"#submission","text":"The TOSTADAS Submission workflow generates the necessary files for Genbank submission, a BioSample ID, then optionally uploads Fastq files via FTP to SRA. This workflow was adapted from SeqSender public database submission pipeline.","title":"Submission"},{"location":"getintouch/","text":"Get in Touch If you have any ideas for ways to improve our existing codebase, feel free to open an Issue Request (found here: Open New Issue) Steps to Open Issue Request: (1) Select Appropriate Template Following the link above, there are four options for issue templates and your selection will depend on (1) if you are a user vs maintainer/collaborator and (2) if the request pertains to a bug vs feature enhancement. Please select the template that accurately reflects your situation. (2) Fill Out Necessary Information Once the appropriate template has been selected, you must fill/answer all fields/questions specified. The information provided will be valuable in getting more information about the issue and any necessary context surrounding it. (3) Submit the Issue Once all information has been provided, you may now submit it! Please allow for some turnaround time for us to review the issue and potentially start addressing it. If this is an urgent request and have not heard from us nor see any progress being made after quite some time (longer than a week), feel free to start a discussion (found here: Start New Discussion) mentioning the following: Issue Number Date Submitted General Background on Bug/Feature Reason for Urgency And we will get back to you as soon as possible.","title":"Get in Touch"},{"location":"getintouch/#get-in-touch","text":"If you have any ideas for ways to improve our existing codebase, feel free to open an Issue Request (found here: Open New Issue)","title":"Get in Touch"},{"location":"getintouch/#steps-to-open-issue-request","text":"","title":"Steps to Open Issue Request:"},{"location":"getintouch/#1-select-appropriate-template","text":"Following the link above, there are four options for issue templates and your selection will depend on (1) if you are a user vs maintainer/collaborator and (2) if the request pertains to a bug vs feature enhancement. Please select the template that accurately reflects your situation.","title":"(1) Select Appropriate Template"},{"location":"getintouch/#2-fill-out-necessary-information","text":"Once the appropriate template has been selected, you must fill/answer all fields/questions specified. The information provided will be valuable in getting more information about the issue and any necessary context surrounding it.","title":"(2) Fill Out Necessary Information"},{"location":"getintouch/#3-submit-the-issue","text":"Once all information has been provided, you may now submit it! Please allow for some turnaround time for us to review the issue and potentially start addressing it. If this is an urgent request and have not heard from us nor see any progress being made after quite some time (longer than a week), feel free to start a discussion (found here: Start New Discussion) mentioning the following: Issue Number Date Submitted General Background on Bug/Feature Reason for Urgency And we will get back to you as soon as possible.","title":"(3) Submit the Issue"},{"location":"installation/","text":"Installation Environment Setup \u2757 Note: If you are a CDC user, please follow the set-up instructions found on Page X - CDC User Guide (1) Clone the repository to your local machine: * git clone https://github.com/CDCgov/tostadas.git \u2757 Note: If you have mamba or nextflow installed in your local environment, you may skip steps 2, 3 (mamba installation) and 6 (nextflow installation) accordingly. (2) Install Mamba: * curl -L -O https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-$(uname)-$(uname -m).sh * bash Mambaforge-$(uname)-$(uname -m).sh -b -p $HOME/mambaforge (3) Add mamba to PATH: * export PATH=\"$HOME/mambaforge/bin:$PATH\" (4) Create the conda environment: If you want to create the full-conda environment needed to run the pipeline outside of Nextflow (this enables you to run individual python scripts), then proceed with step 4a. If you want to run the pipeline using nextflow only (this will be most users), proceed with step 4b. Nextflow will handle environment creation and you would only need to install the nextflow package locally vs the entire environment. (4a) Create the conda environment and install the dependencies set in your environment.yml: cd tostadas mamba env create -n tostadas -f environment.yml (4b) Create an empty conda environment: conda create --name tostadas (5) Activate the environment. conda activate tostadas Verify which environment is active by running the following conda command: * conda env list . The active environment will be denoted with an asterisk * (6) Install Nextflow using Use Mamba and the Bioconda Channel: * mamba install -c bioconda nextflow \u2757 Optionally, you may install nextflow without mamba by following the instructions found in the Nextflow Installation Documentaion Page: Nextflow Install (7) Ensure Nextflow was installed successfully by running nextflow -v Expected Output: nextflow version <CURRENT VERSION> The exact version of Nextflow returned will differ from installation to installation. It is important that the command execute successfully, and a version number is returned. (8) Run one of the following nextflow commands to execute the scripts with default parameters and the local run environment: For Virus Reads nextflow run main.nf -profile test,<singularity/docker/conda> --virus For Bacterial Reads nextflow run main.nf -profile test,<singularity/docker/conda> --bacteria The outputs of the pipeline will appear in the test_output folder within the project directory. You can specify an output directory in the config file or by supplying a path to the --output_dir flag in your nextflow run command.","title":"Install"},{"location":"installation/#installation","text":"","title":"Installation"},{"location":"installation/#environment-setup","text":"\u2757 Note: If you are a CDC user, please follow the set-up instructions found on Page X - CDC User Guide (1) Clone the repository to your local machine: * git clone https://github.com/CDCgov/tostadas.git \u2757 Note: If you have mamba or nextflow installed in your local environment, you may skip steps 2, 3 (mamba installation) and 6 (nextflow installation) accordingly. (2) Install Mamba: * curl -L -O https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-$(uname)-$(uname -m).sh * bash Mambaforge-$(uname)-$(uname -m).sh -b -p $HOME/mambaforge (3) Add mamba to PATH: * export PATH=\"$HOME/mambaforge/bin:$PATH\" (4) Create the conda environment: If you want to create the full-conda environment needed to run the pipeline outside of Nextflow (this enables you to run individual python scripts), then proceed with step 4a. If you want to run the pipeline using nextflow only (this will be most users), proceed with step 4b. Nextflow will handle environment creation and you would only need to install the nextflow package locally vs the entire environment. (4a) Create the conda environment and install the dependencies set in your environment.yml: cd tostadas mamba env create -n tostadas -f environment.yml (4b) Create an empty conda environment: conda create --name tostadas (5) Activate the environment. conda activate tostadas Verify which environment is active by running the following conda command: * conda env list . The active environment will be denoted with an asterisk * (6) Install Nextflow using Use Mamba and the Bioconda Channel: * mamba install -c bioconda nextflow \u2757 Optionally, you may install nextflow without mamba by following the instructions found in the Nextflow Installation Documentaion Page:","title":"Environment Setup"},{"location":"installation/#nextflow-install","text":"(7) Ensure Nextflow was installed successfully by running nextflow -v Expected Output: nextflow version <CURRENT VERSION> The exact version of Nextflow returned will differ from installation to installation. It is important that the command execute successfully, and a version number is returned. (8) Run one of the following nextflow commands to execute the scripts with default parameters and the local run environment:","title":"Nextflow Install"},{"location":"installation/#for-virus-reads","text":"nextflow run main.nf -profile test,<singularity/docker/conda> --virus","title":"For Virus Reads"},{"location":"installation/#for-bacterial-reads","text":"nextflow run main.nf -profile test,<singularity/docker/conda> --bacteria The outputs of the pipeline will appear in the test_output folder within the project directory. You can specify an output directory in the config file or by supplying a path to the --output_dir flag in your nextflow run command.","title":"For Bacterial Reads"},{"location":"links/","text":"Helpful Links Helpful Links for Resources and Software Integrated with TOSTADAS: \ud83d\udd17 Anaconda Install: (https://docs.anaconda.com/anaconda/install/) \ud83d\udd17 Nextflow Documentation: (https://www.nextflow.io/docs/latest/getstarted.html) \ud83d\udd17 SeqSender Documentation: (https://github.com/CDCgov/seqsender) \ud83d\udd17 Liftoff Documentation: (https://github.com/agshumate/Liftoff) \ud83d\udd17 VADR Documentation: (https://github.com/ncbi/vadr.git) \ud83d\udd17 Bakta Documentation: (https://github.com/oschwengers/bakta) \ud83d\udd17 table2asn Documentation: (https://github.com/svn2github/NCBI_toolkit/blob/master/src/app/table2asn/table2asn.cpp) \ud83d\udd17 RepeatMasker Documentation: (https://www.repeatmasker.org/)","title":"Helpful Links"},{"location":"links/#helpful-links","text":"","title":"Helpful Links"},{"location":"links/#helpful-links-for-resources-and-software-integrated-with-tostadas","text":"\ud83d\udd17 Anaconda Install: (https://docs.anaconda.com/anaconda/install/) \ud83d\udd17 Nextflow Documentation: (https://www.nextflow.io/docs/latest/getstarted.html) \ud83d\udd17 SeqSender Documentation: (https://github.com/CDCgov/seqsender) \ud83d\udd17 Liftoff Documentation: (https://github.com/agshumate/Liftoff) \ud83d\udd17 VADR Documentation: (https://github.com/ncbi/vadr.git) \ud83d\udd17 Bakta Documentation: (https://github.com/oschwengers/bakta) \ud83d\udd17 table2asn Documentation: (https://github.com/svn2github/NCBI_toolkit/blob/master/src/app/table2asn/table2asn.cpp) \ud83d\udd17 RepeatMasker Documentation: (https://www.repeatmasker.org/)","title":"Helpful Links for Resources and Software Integrated with TOSTADAS:"},{"location":"quickstart/","text":"Quick Start Steps (1) Check that you are in the directory where the TOSTADAS repository was installed by running pwd Expected Output: /path/to/working/directory/tostadas This is the default directory set in nextflow.config for the provided test input files. (2) Change the submission_config parameter within test_params.config or nextflow.config (if running with your own data) to the location of your personal submission config file. Note that we provide a virus and bacterial test config depending on the use case. \u2757 You must have your personal submission configuration file set up before running the default parameters for the pipeline and/or if you plan on using sample submission at all. More information on setting this up can be found here: More Information on Submission (3) Pipeline Execution Examples We describe a few use-cases of the pipeline below. For more information on input parameters, refer to the documentation found in the following pages: Profile Options and Input Files Parameters \u2757 Note: For all use cases, the paths to the required files should be specified in the nextflow.config file or the params.yaml file. Use Case 1: Running Annotation and Submission Annotate viral assemblies and submit to GenBank and SRA Required files: fasta files, metadata file nextflow run main.nf -profile <singularity/docker/conda> --virus --genbank --sra --submission_wait_time 5 Breakdown: -profile: This parameter is required. Specify the profile and run-time environment ( singularity , docker or conda ). Conda implementation is less stable, singularity or docker is recommended. --virus: The pathogen type is specified as virus --sra: sra is specified as the database to submit to --submission_wait_time : This parameter is optional. Running the pipeline with default parameters will trigger a wait time equal to # of samples * 180 seconds. This default parameter can be overridden by supplying an integer value to the submission_wait_time parameter. --genbank : genbank is specified as the database to submit to \u2757 Pre-requisite to submit to GenBank: In order to submit to GenBank, the program table2asn must be executable in your local environment. Copy the program table2asn to you tostadas/bin directory by running the following lines of code: cd ./tostadas/bin/ wget https://ftp.ncbi.nlm.nih.gov/asn1-converters/by_program/table2asn/linux64.table2asn.gz gunzip linux64.table2asn.gz mv linux64.table2asn table2asn Annotate bacterial assemblies and submit to GenBank and SRA ** Required files: fasta files, metadata file (A) Download BAKTA Database nextflow run main.nf -profile <singularity/docker/conda> --bacteria --genbank --sra --submission_wait_time 5 --download_bakta_db --bakta_db_type <light/full> (B) Provide path to existing BAKTA Database nextflow run main.nf -profile <singularity/docker/conda> --bacteria --genbank --sra --submission_wait_time 5 --bakta_db_path Breakdown: --bacteria : The pathogen type is specified as bacteria --genbank : genbank is specified as the database to submit to","title":"Quick Start"},{"location":"quickstart/#quick-start","text":"","title":"Quick Start"},{"location":"quickstart/#steps","text":"(1) Check that you are in the directory where the TOSTADAS repository was installed by running pwd Expected Output: /path/to/working/directory/tostadas This is the default directory set in nextflow.config for the provided test input files. (2) Change the submission_config parameter within test_params.config or nextflow.config (if running with your own data) to the location of your personal submission config file. Note that we provide a virus and bacterial test config depending on the use case. \u2757 You must have your personal submission configuration file set up before running the default parameters for the pipeline and/or if you plan on using sample submission at all. More information on setting this up can be found here: More Information on Submission (3) Pipeline Execution Examples We describe a few use-cases of the pipeline below. For more information on input parameters, refer to the documentation found in the following pages:","title":"Steps"},{"location":"quickstart/#profile-options-and-input-files","text":"","title":"Profile Options and Input Files"},{"location":"quickstart/#parameters","text":"\u2757 Note: For all use cases, the paths to the required files should be specified in the nextflow.config file or the params.yaml file.","title":"Parameters"},{"location":"quickstart/#use-case-1-running-annotation-and-submission","text":"Annotate viral assemblies and submit to GenBank and SRA Required files: fasta files, metadata file nextflow run main.nf -profile <singularity/docker/conda> --virus --genbank --sra --submission_wait_time 5","title":"Use Case 1: Running Annotation and Submission"},{"location":"quickstart/#breakdown","text":"-profile: This parameter is required. Specify the profile and run-time environment ( singularity , docker or conda ). Conda implementation is less stable, singularity or docker is recommended. --virus: The pathogen type is specified as virus --sra: sra is specified as the database to submit to --submission_wait_time : This parameter is optional. Running the pipeline with default parameters will trigger a wait time equal to # of samples * 180 seconds. This default parameter can be overridden by supplying an integer value to the submission_wait_time parameter. --genbank : genbank is specified as the database to submit to \u2757 Pre-requisite to submit to GenBank: In order to submit to GenBank, the program table2asn must be executable in your local environment. Copy the program table2asn to you tostadas/bin directory by running the following lines of code: cd ./tostadas/bin/ wget https://ftp.ncbi.nlm.nih.gov/asn1-converters/by_program/table2asn/linux64.table2asn.gz gunzip linux64.table2asn.gz mv linux64.table2asn table2asn Annotate bacterial assemblies and submit to GenBank and SRA ** Required files: fasta files, metadata file (A) Download BAKTA Database nextflow run main.nf -profile <singularity/docker/conda> --bacteria --genbank --sra --submission_wait_time 5 --download_bakta_db --bakta_db_type <light/full> (B) Provide path to existing BAKTA Database nextflow run main.nf -profile <singularity/docker/conda> --bacteria --genbank --sra --submission_wait_time 5 --bakta_db_path Breakdown: --bacteria : The pathogen type is specified as bacteria --genbank : genbank is specified as the database to submit to","title":"Breakdown:"}]}