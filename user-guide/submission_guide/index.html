<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=Tostadas><meta name=author content=SciComp><link href=../general_NCBI_submission_guide/ rel=prev><link href=../outputs/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.1.6"><title>3. Submission Guide - Tostadas</title><link rel=stylesheet href=../../assets/stylesheets/main.ded33207.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#submission-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Tostadas class="md-header__button md-logo" aria-label=Tostadas data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tostadas </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 3. Submission Guide </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/CDCgov/tostadas/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> CDCgov/Tostadas </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Background </a> </li> <li class=md-tabs__item> <a href=../installation/ class="md-tabs__link md-tabs__link--active"> General Usage </a> </li> <li class=md-tabs__item> <a href=../cdc-user-guide/ class=md-tabs__link> CDC Specific Usage </a> </li> <li class=md-tabs__item> <a href=../custom_metadata_guide/ class=md-tabs__link> Advanced Usage </a> </li> <li class=md-tabs__item> <a href=../get-in-touch/ class=md-tabs__link> FAQ </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Tostadas class="md-nav__button md-logo" aria-label=Tostadas data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> Tostadas </label> <div class=md-nav__source> <a href=https://github.com/CDCgov/tostadas/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> CDCgov/Tostadas </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Background </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> General Usage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> General Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> 1. Installation </a> </li> <li class=md-nav__item> <a href=../general_NCBI_submission_guide/ class=md-nav__link> 2. General NCBI Guide </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 3. Submission Guide <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 3. Submission Guide </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> Table of Contents </a> </li> <li class=md-nav__item> <a href=#putting-together-the-nextflow-command class=md-nav__link> Putting together the Nextflow command </a> </li> <li class=md-nav__item> <a href=#choosing-a-workflow class=md-nav__link> Choosing a workflow </a> </li> <li class=md-nav__item> <a href=#choosing-an-organism-type-andor-virus-subtype class=md-nav__link> Choosing an organism type and/or virus subtype </a> </li> <li class=md-nav__item> <a href=#using-specific-profiles class=md-nav__link> Using specific profiles </a> </li> <li class=md-nav__item> <a href=#other-customizations class=md-nav__link> Other customizations </a> </li> <li class=md-nav__item> <a href=#submitting-to-production class=md-nav__link> Submitting to Production </a> </li> <li class=md-nav__item> <a href=#typical-example-workflow class=md-nav__link> Typical example workflow </a> </li> <li class=md-nav__item> <a href=#submission-config-fields class=md-nav__link> Submission config fields </a> </li> <li class=md-nav__item> <a href=#custom-metadata-validation-and-custom-biosample-package class=md-nav__link> Custom metadata validation and custom BioSample package </a> <nav class=md-nav aria-label="Custom metadata validation and custom BioSample package"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#built-in-biosample-package-profiles class=md-nav__link> Built-in BioSample package profiles </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../outputs/ class=md-nav__link> 4. Output </a> </li> <li class=md-nav__item> <a href=../parameters/ class=md-nav__link> 5. Parameters </a> </li> <li class=md-nav__item> <a href=../profile/ class=md-nav__link> 6. Profiles </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> CDC Specific Usage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> CDC Specific Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cdc-user-guide/ class=md-nav__link> 1. CDC User-Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> Advanced Usage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Advanced Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../custom_metadata_guide/ class=md-nav__link> 1. Custom Metadata </a> </li> <li class=md-nav__item> <a href=../user_provided_annotation_guide/ class=md-nav__link> 2. User Provided Annotation </a> </li> <li class=md-nav__item> <a href=../vadr_install/ class=md-nav__link> 3. VADR Installation </a> </li> <li class=md-nav__item> <a href=../wastewater_guide/ class=md-nav__link> 4. Wastewater Submission </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> FAQ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> FAQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../get-in-touch/ class=md-nav__link> Get in Touch </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../contributions/ class=md-nav__link> Contributions </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=submission-guide>Submission Guide<a class=headerlink href=#submission-guide title="Permanent link">&para;</a></h1> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ul> <li><a href=#putting-together-the-nextflow-command>Putting together the Nextflow command</a></li> <li><a href=#choosing-a-workflow>Choosing a workflow</a></li> <li><a href=#choosing-an-organism-type-andor-virus-subtype>Choosing an organism type and/or virus subtype</a></li> <li><a href=#using-specific-profiles>Using specific profiles</a></li> <li><a href=#other-customizations>Other customizations</a></li> <li><a href=#submitting-to-production>Submitting to Production</a></li> <li><a href=#typical-example-workflow>Typical example workflow</a></li> <li><a href=#submission-config-fields>Submission config fields</a></li> <li><a href=#custom-metadata-validation-and-custom-biosample-package>Custom metadata validation and custom BioSample package</a></li> <li><a href=#built-in-biosample-package-profiles>Built-in BioSample package profiles</a></li> </ul> <h2 id=putting-together-the-nextflow-command>Putting together the Nextflow command<a class=headerlink href=#putting-together-the-nextflow-command title="Permanent link">&para;</a></h2> <p>Your basic command starts like this: <code>nextflow run main.nf -profile &lt;docker|singularity|conda&gt;</code> but needs to be confiured further. See below.</p> <h2 id=choosing-a-workflow>Choosing a workflow<a class=headerlink href=#choosing-a-workflow title="Permanent link">&para;</a></h2> <p>Choose how you want to run TOSTADAS using the <code>--workflow</code> parameter:</p> <ul> <li><strong>biosample_and_sra</strong>: Runs a submission to BioSample and SRA. Add <code>--biosample false</code> or <code>--sra false</code> to toggle off submission to one or the other.</li> <li><strong>genbank</strong>: Runs a GenBank submission. This requires an updated metadata file that includes <code>biosample_accession</code> as required by NCBI.</li> <li><strong>fetch_accessions</strong>: Fetches reports and updates the metadata file.</li> <li><strong>full_submission</strong>: Executes BioSample and SRA submissions, waits 60 seconds multiplied by <code>--batch_size</code>, fetches reports, updates the metadata file with accession IDs, and then performs the GenBank submission.</li> <li><strong>update_submission</strong>: Executes a BioSample submission using an updated metadata Excel file.</li> </ul> <h2 id=choosing-an-organism-type-andor-virus-subtype>Choosing an organism type and/or virus subtype<a class=headerlink href=#choosing-an-organism-type-andor-virus-subtype title="Permanent link">&para;</a></h2> <p>If you want to run viral annotation, you need to specify a <code>--virus_subtype &lt;mpxv|rsv&gt;</code>. This tells TOSTADAS which annotator profile to use if you're running VADR.</p> <p>If you want to run bacterial annotation, you need to specify <code>--organism_type bacteria</code>. This tells TOSTADAS to annotate using bakta. You can instead use a profile (see <a href=#using-specific-profiles>Using specific profiles</a>).</p> <p>If you're submitting to GenBank (the only option if you want to run annotation), you need to specify <code>--organism_type &lt;virus|bacteria|eukaryote&gt;</code>. This tells TOSTADAS which kind of GenBank submission to do. FTP submission to GenBank is only supported for bacteria and eukaryote assemblies. Virus assemblies must be submitted via email (either using TOSTADAS or manually emailing the files in the results folder).</p> <h2 id=using-specific-profiles>Using specific profiles<a class=headerlink href=#using-specific-profiles title="Permanent link">&para;</a></h2> <p>TOSTADAS supports some profiles to make submission easier. These are specified in the <code>-profile</code> option. See <a href=#custom-metadata-validation-and-custom-biosample-package>Custom metadata validation and custom BioSample package</a> for more detail.</p> <ul> <li><strong>test</strong>: Runs a test submission. It prepares all the files but does not actually submit to the test server. To submit to the test server, add <code>dry_run false</code></li> <li><strong>nwss</strong>: Submits to SARS-CoV-2.wwsurv.1.0 BioSample package.</li> <li><strong>pulsenet</strong>: Submits to OneHealthEnteric.1.0 BioSample package. </li> <li><strong>virus</strong>: Sets defaults for virus submission (to run a test bacteria submission, use <code>profile test,virus,&lt;docker|singularity|conda&gt;</code>)</li> <li><strong>bacteria</strong>: Sets defaults for bacteria submission (to run a test bacteria submission, use <code>profile test,bacteria,&lt;docker|singularity|conda&gt;</code>)</li> <li><strong>mpox</strong>: Sets defaults for MPOX submission (to run a test MPOX submission, use <code>profile test,mpox,&lt;docker|singularity|conda&gt;</code>)</li> <li><strong>rsv</strong>: Sets defaults for RSV submission (to run a test RSV submission, use <code>profile test,rsv,&lt;docker|singularity|conda&gt;</code>)</li> </ul> <h2 id=other-customizations>Other customizations<a class=headerlink href=#other-customizations title="Permanent link">&para;</a></h2> <p>All the custom parameters for TOSTADAS are found in nextflow.config and the config files inside <code>conf/</code>. You can override any of these by specifying the parameter on the command line.</p> <p>For example, the default output directory is <code>results</code>, but you can override that and choose your own output directory using <code>--outdir path/to/my/output</code> in your command.</p> <p>TOSTADAS can chunk large datasets into smaller groups to submit to NCBI's servers using the <code>--batch_size</code> flag. If you have a metadata Excel file with 200 samples, you can submit them in batches of 50 by adding <code>--batch_size 50</code> to your command. This groups 50 samples at a time into one submission file for each data repository. NCBI much prefers this over submitting samples one-at-a-time. </p> <p>We <strong>highly</strong> recommend you submit using batches!!! We suggest 50 as a maximum batch size. </p> <p>Another example: the <code>--dry_run</code> flag (which prepares files for submission but doesn't upload to the server) defaults to <code>true</code> for the test profile and <code>false</code> otherwise, but you can override it by specifying <code>--dry_run &lt;true|false&gt;</code> on the command line.</p> <h2 id=submitting-to-production>Submitting to Production<a class=headerlink href=#submitting-to-production title="Permanent link">&para;</a></h2> <p>TOSTADAS defaults to submitting to the test server even if not using the test profile, to avoid accidentally pushing data to NCBI's Production server. </p> <p>When you've completed testing and are ready to submit for production, add <code>--prod_submission</code> to your command line (or change <code>prod_submission</code> to <code>true</code> in <code>nextflow.config</code>). </p> <h2 id=typical-example-workflow>Typical example workflow<a class=headerlink href=#typical-example-workflow title="Permanent link">&para;</a></h2> <p>We'll run test submissions to BioSample and SRA using the test MPOX data included in the repository. </p> <p>Submit to biosample and sra: <br> <code>nextflow run main.nf -profile test,singularity,mpox --workflow biosample_and_sra --dry_run false --submission_config conf/submission_config.yaml --batch_size 5</code> <br> <strong>Remember</strong> to add credentials to your submission_config.yaml file. </p> <p>Fetch the accessions if they weren’t assigned (this workflow creates an updated Metadata Excel file with the validated fields and the accession IDs): <br> <code>nextflow run main.nf -profile test,singularity,mpox --workflow fetch_accessions --dry_run false --submission_config conf/submission_config.yaml</code> </p> <p>Submit an updated biosample submission (open the updated Excel file from results/mpxv_test_metadata/final_submission_outputs/mpxv_test_metadata_updated.xlsx and add some fake SAMN IDs first): <br> <code>nextflow run main.nf -profile test,singularity --workflow update_submission --dry_run false --species mpxv --submission_config conf/submission_config.yaml --batch_size 5 --original_submission_outdir results/mpxv_test_metadata/submission_outputs --meta_path results/mpxv_test_metadata/final_submission_outputs/mpxv_test_metadata_updated.xlsx</code> <br> <strong>Remember</strong> This won’t run without those fake SAMN IDs in the biosample_accession field. </p> <p>Now we'll run a test GenBank submission using the test bacteria data included in the repository. </p> <p>Submit to BioSample first (because GenBank requires a BioSample accession): <br> <code>nextflow run main.nf -profile test,singularity,bacteria --workflow biosample_and_sra --dry_run false --submission_config conf/submission_config.yaml</code> </p> <p>Open the updated Excel file from results/bacteria_test_metadata_1/final_submission_outputs/bacteria_test_metadata_1_updated.xlsx and add some fake SAMN IDs first. <br> <strong>The next command won't run without the fake SAMN IDs in biosample_accession column</strong>. <br> <code>nextflow run main.nf -profile test,singularity,bacteria --workflow genbank --dry_run false --submission_config conf/submission_config.yaml --annotation --download_bakta_db --bakta_db_light</code> </p> <h2 id=submission-config-fields>Submission config fields<a class=headerlink href=#submission-config-fields title="Permanent link">&para;</a></h2> <p>The fields and corresponding example values can be found here: <a href=https://github.com/CDCgov/tostadas/raw/master/conf/submission_config.yaml>Submission Config</a>.</p> <table> <thead> <tr> <th>Field Name</th> <th>Description</th> <th>Input Required</th> </tr> </thead> <tbody> <tr> <td>NCBI / username</td> <td>Your personal username credential for NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>NCBI / password</td> <td>Your personal password credential for NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>NCBI_ftp_host</td> <td>The FTP host name for NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>NCBI_sftp_host</td> <td>The SFTP host name for NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>NCBI_API_URL</td> <td>URL for the NCBI API</td> <td>Yes (string)</td> </tr> <tr> <td>table2asn_email</td> <td>Email address for GenBank email submission</td> <td>No (string)</td> </tr> <tr> <td>BioSample_package</td> <td>Name of BioSample package for submission</td> <td>Yes (string)</td> </tr> <tr> <td>Role</td> <td>Role of person submitting (should be "owner")</td> <td>Yes (string)</td> </tr> <tr> <td>Type</td> <td>Type of submission (should usually be "institute")</td> <td>Yes (string)</td> </tr> <tr> <td>NCBI_Namespace</td> <td>An SPUID attribute that is unique for each submitter, coordinate this with NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>Org_ID</td> <td>Organization ID for NCBI</td> <td>Yes (string)</td> </tr> <tr> <td>Submitting_Org</td> <td>Name of the organization or company you are affiliated with</td> <td>Yes (string)</td> </tr> <tr> <td>Submitting_Org_Dept</td> <td>Name of the department with organization or company</td> <td>No (string)</td> </tr> <tr> <td>Street</td> <td>Street address of the organization or company</td> <td>Yes (string)</td> </tr> <tr> <td>City</td> <td>City of the organization or company</td> <td>Yes (string)</td> </tr> <tr> <td>State</td> <td>State of the organization or company</td> <td>Yes (string)</td> </tr> <tr> <td>Postal_Code</td> <td>Zip code of the organization or company</td> <td>Yes (string)</td> </tr> <tr> <td>Country</td> <td>Country of the organization or company</td> <td>Yes (string)</td> </tr> <tr> <td>Email</td> <td>Submitter's email address</td> <td>Yes (string)</td> </tr> <tr> <td>Phone</td> <td>Submitter's phone number</td> <td>No (string)</td> </tr> <tr> <td>Specified_Release_Date</td> <td>Specify a date to release the samples to the public repository</td> <td>No (string)</td> </tr> <tr> <td>Submitter</td> <td>Leave blank</td> <td>Yes (blank)</td> </tr> <tr> <td>'<a class="magiclink magiclink-github magiclink-mention" href=https://github.com/email title="GitHub User: email">@email</a>'</td> <td>Submitter's email address</td> <td>Yes (string)</td> </tr> <tr> <td>'<a class="magiclink magiclink-github magiclink-mention" href=https://github.com/alt_email title="GitHub User: alt_email">@alt_email</a>'</td> <td>An alternate email address to also receive NCBI submission notification emails</td> <td>Yes (string)</td> </tr> <tr> <td>Name</td> <td>Leave blank</td> <td>Yes (blank)</td> </tr> <tr> <td>First</td> <td>Submitter's first name</td> <td>Yes (string)</td> </tr> <tr> <td>Last</td> <td>Submitter's last name</td> <td>Yes (string)</td> </tr> </tbody> </table> <h2 id=custom-metadata-validation-and-custom-biosample-package>Custom metadata validation and custom BioSample package<a class=headerlink href=#custom-metadata-validation-and-custom-biosample-package title="Permanent link">&para;</a></h2> <p>TOSTADAS defaults to Pathogen.cl.1.0 (Pathogen: clinical or host-associated; version 1.0) NCBI BioSample package for submissions to the BioSample repository. You can submit using a different BioSample package by doing the following:</p> <ol> <li>Change the package name in the <code>conf/submission_config.yaml</code>. Choose one of the available <a href=https://www.ncbi.nlm.nih.gov/biosample/docs/packages/ >NCBI BioSample packages</a>.</li> <li>Add the necessary fields for your BioSample package to your input Excel file.</li> <li>Add those same fields as keys to the JSON file (<code>assets/custom_meta_fields/example_custom_fields.json</code>) and provide key info as needed. This lets TOSTADAS know to validate and submit those added fields.</li> <li>Tell TOSTADAS to validate this metadata by adding: <code>--custom_fields_file &lt;path/to/metadata_custom_fields.json&gt; --validate_custom_fields</code> to your command.</li> </ol> <p>replace_empty_with: TOSTADAS will replace any empty cells with this value (Example application: NCBI expects some value for any mandatory field, so if empty you may want to change it to "Not Provided".)</p> <p>new_field_name: TOSTADAS will replace the field name in your metadata Excel file with this value. (Example application: you get weekly metadata Excel files and they specify 'animal_environment' but NCBI expects 'animal_env'; you can specify this once in the JSON file and it will be changed on every run.)</p> <p><strong>Note</strong>: All fields for the BioSample package Pathogen.cl.1.0. are already in the metadata template.</p> <h3 id=built-in-biosample-package-profiles>Built-in BioSample package profiles<a class=headerlink href=#built-in-biosample-package-profiles title="Permanent link">&para;</a></h3> <p>TOSTADAS has built-in profiles for two BioSample packages to support specific programs. These profiles automatically import a custom_fields JSON file preconfigured for that package. Here's how to use them:</p> <ul> <li>SARS-CoV-2.wwsurv.1.0 <ol> <li>Change the BioSample_package field in <code>conf/submission_config.yaml</code> to <code>SARS-CoV-2.wwsurv.1.0</code></li> <li>Use <code>assets/sample_metadata/wastewater_biosample_template.xlsx</code> as your metadata template</li> <li>Run as: <code>nextflow run main.nf -profile nwss,&lt;docker|singularity&gt; --meta_path &lt;path/to/metadata_file.xlsx&gt; --submission_config &lt;path/to/submission_config.yaml&gt;</code></li> </ol> </li> <li>OneHealthEnteric.1.0<ol> <li>Change the BioSample_package field in <code>conf/submission_config.yaml</code> to <code>OneHealthEnteric.1.0</code></li> <li>Use <code>assets/sample_metadata/onehealth_biosample_package_template.xlsx</code> as your metadata template</li> <li>Run as: <code>nextflow run main.nf -profile pulsenet,&lt;docker|singularity&gt; --meta_path &lt;path/to/metadata_file.xlsx&gt; --submission_config &lt;path/to/submission_config.yaml&gt;</code></li> </ol> </li> </ul> <hr> <div class=md-source-file> <small> Last update: 2025-09-20 </small> </div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 CDC SciComp </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.cdc.gov/amd/index.html target=_blank rel=noopener title=www.cdc.gov class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M144 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zm368 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zM0 298.7C0 239.8 47.8 192 106.7 192h42.7c15.9 0 31 3.5 44.6 9.7-1.3 7.2-1.9 14.7-1.9 22.3 0 38.2 16.8 72.5 43.3 96H21.3C9.6 320 0 310.4 0 298.7zM405.3 320h-.7c26.6-23.5 43.3-57.8 43.3-96 0-7.6-.7-15-1.9-22.3 13.6-6.3 28.7-9.7 44.6-9.7h42.7c58.9 0 106.7 47.8 106.7 106.7 0 11.8-9.6 21.3-21.3 21.3H405.3zM224 224a96 96 0 1 1 192 0 96 96 0 1 1-192 0zm-96 261.3c0-73.6 59.7-133.3 133.3-133.3h117.4c73.6 0 133.3 59.7 133.3 133.3 0 14.7-11.9 26.7-26.7 26.7H154.7c-14.7 0-26.7-11.9-26.7-26.7z"/></svg> </a> <a href=https://github.com/CDCgov target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "toc.integrate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.51198bba.min.js></script> </body> </html>